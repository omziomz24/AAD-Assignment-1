---
title: "AAD Assignment 1 - Group 26"
author: "Omar, Eloise, Alina, Sue"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(car)
library(dplyr)
library(ggplot2)
library(car)

library(corrplot) # for correlation plot 
```


------------------------------------------------------------------------------------------

# 2.1 Descriptive Analysis of the Data Set

```{r }
# Load the data 
data <- read.csv("Assignt1_data.csv", header = TRUE)

# Summary Stas of the Original Data 
str(data) 
head(data)
dim(data) 
summary(data)
```

```{r}

# Clean the data 
colSums(is.na(data))  # Count NAs in each column
# 190 out of 18640 rows with na values in aveBedrooms 
clean_data <- na.omit(data) # remove na rows 

# Summary Stats of the Cleaned Data 
str(clean_data) 
head(clean_data)
dim(clean_data) 
summary(clean_data)
```


### Histogram of the Response Variable 
```{r}
hist(clean_data$medianHouseValue,
     breaks = 30,
     freq = FALSE,
     main = "Histogram of Median Housing Value")
lines(density(clean_data$medianHouseValue), col = "red", lwd = 2)
boxplot(clean_data$medianHouseValue)

hist(data_naomit$medianHouseValue,
     xlab = "Median House Value ($)",
     ylab = "Frequency",
     main = "Hostogram of Median House Value",
     breaks = 25)
```
The boxplot clearly indicates that the Median House Value is right-skewed, with a longer tail on the higher end. Additionally, there are several outliers present at the upper extreme of the distribution

```{r}
# Correlations 
numeric.data <-  clean_data[sapply(clean_data, is.numeric)]
head(numeric.data)
cor_medianHouseValue <- cor(clean_data$medianHouseValue, 
                            clean_data[, c("longitude", 
                                            "latitude", 
                                            "housingMedianAge",
                                            "aveRooms",
                                            "aveBedrooms",
                                            "population",
                                            "medianIncome")])
print(cor_medianHouseValue)
corrplot(cor(clean_data[, sapply(clean_data, is.numeric)]), method = "circle")
```

### Outliers Detection
```{r}
boxplot_medianHouseValue <- boxplot(clean_data$medianHouseValue,
        main = "Boxplot of Medin House Value", 
        outline = TRUE, 
        col = "lightblue", 
        horizontal = TRUE,
        cex = 1, 
        col.out = "red", 
        pch = 16)
grid()

outliers <- boxplot_medianHouseValue$out
num_outliers <- length(outliers) 
print(paste("Number of outliers:", num_outliers))
```
### Pairwise Plots 
```{r, echo=FALSE}
# Pairwise scatter plots for numeric variables 
pairs(clean_data[, 
                 c("longitude", 
                   "latitude", 
                   "housingMedianAge", 
                   "aveRooms", 
                   "population", 
                   "medianIncome", 
                   "medianHouseValue")],
      cex = 0.1)

```

### More Plots: Median House Value with Median Income 
```{r}
options(scipen = 999)
plot(clean_data$medianIncome, clean_data$medianHouseValue,
     xlab = "Median Income ($10,000's)", ylab = "Median House Value ($)",
     main = "Scatter Plot of Median Income and Median House Value",
     cex = 0.1,
     col = "red",
     xlim = c(0, 16),
     ylim = c(0, 600000), 
     cex.axis = 0.8)
```
### More Plots: Boxplot of Average Rooms 
Some extreme outliers here
```{r}
boxplot(data$aveRooms, 
        main = "Boxplot of Average Rooms",
        cex = 0.5,
        pch = 16, 
        col = "red",
        horizontal = TRUE)
```

### Geospacial Plot: Median House Value 
```{r}
ggplot(clean_data, aes(x = clean_data$longitude, y = clean_data$latitude)) + 
  geom_point(aes(color = clean_data$medianHouseValue), size = 0.7) + 
  scale_color_gradient(low = "blue", high = "red", 
                       name = "Median House Value ($)") +
  theme_minimal() + 
  ggtitle("Geospatial Plot of Median Housing Price") + 
  labs(x = "Longitude", y = "Latitude") 

# Longitude represents east-west position (-180: west, 180: east) 
# Latitude represents north-south position  (-90: south, 90:north) 
```
At a glance, median housing value is higher in the South than in the North. 

There are some observable clusters. For example, the region around (-122.5, 37.5) and the region around (-118.75, 33.75) has highest density of high median housing values. These two regions has pretty high data point desity to begin with - thats why we also observe higher density of high value houses. 

### Geospacial Plot: Median Income 
expect to see similar pattern as above 
```{r}
ggplot(clean_data, aes(x = clean_data$longitude, y = clean_data$latitude)) + 
  geom_point(aes(color = clean_data$medianIncome), size = 0.7) + 
  scale_color_gradient(low = "blue", high = "red", 
                       name = "Median Income ($10,000's)") +
  theme_minimal() + 
  ggtitle("Geospatial Plot of Median Income ($10,000's)") + 
  labs(x = "Longitude", y = "Latitude") 
```











------------------------------------------------------------------------------------------

# 2.2 Multiple Linear Regression 

### MLR Using all predictors (id is not a predictor)

The p-value of the F-test is practically zero, therefore we have sufficient evidence to reject the null hypothesis that all regression coefficients are zero. This means that the model has overall significance, and that at least one of the predictors are useful in explaning the variation in the response variable (i.e. medianHouseValue). 

Having concluded that this model (fit1_MHV) has overall significance, we can gauge the significance of individual predictors through the t-test p-values. It is clear that population is not useful, as we do not have sufficient evidence to reject the null hypothesis that its corresponding coefficient is non-zero. The dummy variable, "NEAR BAY", associated to the categorical predictor, "oceanProximity", is also shown to be insignificant. This might be an indication that comparing to the base case (<1H OCEAN), NEAR BAY does not lead to significant change in Median House Price. 

```{r}
fit1 <- lm(clean_data$medianHouseValue ~. - id, data = clean_data) 
summary(fit1)
```

### Residual plot etc 
```{r}
par(mfrow = c(2,2))
plot(fit1, cex = 0.1)
```
```{r}
par(mfrow = c(1, 1)) # Lets look at these plots more closely 
 
```




### Outliers 
```{r}

```

### High Leverage Points 
```{r}

```

## Collinearity 
The arbitrary threshold of severe collinearity is vif greater or equal to 5. Here, 
all the predictors are shown to have a non-severe VIF. 
```{r}
vif(fit1_MHV)
```




